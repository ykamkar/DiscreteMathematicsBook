\SUBSECTION{حل روابط بازگشتی خطی ناهمگن}
\begin{definition}
    \focused{رابطه‌ بازگشتی خطی ناهمگن از درجه $k$}
    رابطه‌ای به فرم
   \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}+F(n)\]
   است که
   $F(n)$
   ثابت صفر نباشد
   ,
   $\forall{i}:c_i \in \mathbb{R} $
   و 
   $ c_k\neq 0$

\end{definition}

مثلا رابطه‌ 
$a_n=a_{n-1}+3a_{n-2}+3n+2^n$
یک رابطه‌ خطی ناهمگن از درجه ۲ است.

\begin{theorem}
    قضیه ۵:
    اگر 
    $\{a^{(p)}_n\}$
    جواب خاص رابطه‌ بازگشتی خطی ناهمگن با ضرایب ثابت
    \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}+F(n)\]
    باشد,
    آنگاه همه جواب‌ها به فرم 
    $\{a^{(p)}_n+a^{(h)}_n\}$
    است که
    $\{a^{(h)}_n\}$
    جواب رابطه‌ بازگشتی خطی همگن
    \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}\]
    است.
\end{theorem}

\begin{problem}
    تمام جواب‌های رابطه‌ بازگشتی
    $a_n=4a_{n-1}+3n$
    را به دست آورید.
    \problemsolution{
        برای حل این رابطه‌ ابتدا رابطه‌ بازگشتی همگن
        $a_n=4a_{n-1}$
        را حل می کنیم:
        $a_n^{(h)}=\alpha 4^n$

        حال جواب خاص معادله را به دست می‌آوریم, با توجه به این که
        $F(n)=3n$
        یک چند جمله‌ای است, حدس می‌زنیم که جواب می‌تواند به فرم
        $a_n=cn+d$
        باشد
        اگر چنین باشد داریم:
        \[cn+d=4c(n-1)+4d+3n\]
        \[\rightarrow n(-3-3c)+(-3d+4c)=0 \]
        \[\rightarrow (-3-3c)=0 \rightarrow c=-1\]
        \[\rightarrow (-3d+4c)=0 \rightarrow d=-\dfrac{3}{4} \]
        \[\rightarrow a_n^{(p)}=-n-\dfrac{3}{4} \]
        \[\rightarrow a_n= a^{(p)}_n+a^{(h)}_n=\alpha 4^n-n-\dfrac{3}{4}\]
    }
\end{problem}

\begin{theorem}
    قضیه ۶:
    اگر معادله بازگشتی خطی همگن به فرم
    \[a_n=c_{1}a_{n-1}+c_{2}a_{n-2}+...+c_{k}a_{n-k}+F(n)\]
    داشته باشیم که
    \[F(n)=(b_tn^t+b_{t-1}n^{t-1}+...+b_1n+b_0)s^n\]
    باشذ آنگاه اگر 
    $s$
    ریشه معادله مشخصه نباشد معادله دارای جواب خاصی به فرم
    \[(p_tn^t+p_{t-1}n^{t-1}+...+p_1n+p_0)s^n\]
    است و اگر
    $s$
    ریشه معادله مشخصه باشد و درجه آن 
    $m$
    باشد, معادله دارای جواب خاصی به فرم
    \[n^m(p_tn^t+p_{t-1}n^{t-1}+...+p_1n+p_0)s^n\]
    است.
\end{theorem}

\begin{problem}
    نمونه سوال اضافه شود.
\end{problem}